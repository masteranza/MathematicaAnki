(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     42861,       1169]
NotebookOptionsPosition[     42010,       1140]
NotebookOutlinePosition[     42852,       1168]
CellTagsIndexPosition[     42809,       1165]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<ScienceReport`\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<ErrorBarPlots`\>\"", ",", "\"\<PackageUtils`\>\""}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefPic", "::", "usage"}], " ", "=", 
   "\"\<Refers to a FigureCaptionNumbered\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefEq", "::", "usage"}], " ", "=", 
    "\"\<Refers to an EquationNumbered\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "::", "usage"}], "=", 
   "\"\<Container for messurments Mes[value,error,unit]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimpleTable", "::", "usage"}], "=", 
   "\"\<Grid with some simple formatting options and optional label with \
comment\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EquationNumbered", "::", "usage"}], "=", 
   "\"\<Assigns function to it's name and prints it nicely\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearRegressionXYError", "::", "usage"}], "=", 
   "\"\<Assigns function to it's name and prints it nicely\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotRegression", "::", "usage"}], "=", 
   "\"\<Takes linear regression model with uncertainties, data, errors and \
label plots to plot them all together\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StackVar", "::", "usage"}], "=", 
   "\"\<Takes variable and appends it to tvars list for later usage\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PresentValue", "::", "usage"}], "=", 
   "\"\<Changes list {var,err,unit} to nice format\>\""}], ";", " ", 
  RowBox[{
   RowBox[{"TotalDiffrentialError", "::", "usage"}], "=", 
   "\"\<Presents and calculates the expression for error\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"da", "::", "usage"}], "=", 
   "\"\<Calculates error of a given lm fit\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"db", "::", "usage"}], "=", "\"\<Calculates error of b\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RefLastPic", "::", "usage"}], " ", "=", 
   "\"\<Inserts number of last FigureCaptionNumbered\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledPlot", "::", "usage"}], "=", 
   "\"\<Creates a styled Plot with grid\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledListPlot", "::", "usage"}], "=", 
   "\"\<Creates a styled ListPlot with grid\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledListLogPlot", "::", "usage"}], "=", 
   "\"\<Creates a styled ListLogPlot with grid\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledErrorListPlot", "::", "usage"}], "=", 
   "\"\<Creates a styled ErrorListPlot with grid\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledErrorListPlotRegression", "::", "usage"}], "=", 
   "\"\<Creates a styled ErrorListPlot with grid and given linear \
regression\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefPic", "[", "tag_", "]"}], " ", ":=", " ", 
  RowBox[{"NotebookWrite", "[", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", 
    RowBox[{"RowBox", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<[\>\"", ",", " ", 
       RowBox[{"CounterBox", "[", 
        RowBox[{"\"\<FigureCaptionNumbered\>\"", ",", " ", 
         RowBox[{"ToString", "@", "tag"}]}], "]"}], ",", " ", "\"\<]\>\""}], 
      "}"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RefEq", "[", "tag_", "]"}], " ", ":=", " ", 
   RowBox[{"NotebookWrite", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", " ", 
     RowBox[{"RowBox", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<[\>\"", ",", " ", 
        RowBox[{"CounterBox", "[", 
         RowBox[{"\"\<EquationNumbered\>\"", ",", " ", 
          RowBox[{"ToString", "@", "tag"}]}], "]"}], ",", " ", "\"\<]\>\""}], 
       "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledPlot", "[", "x__", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Dashed"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledListPlot", "[", "x__", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Dashed"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledListLogPlot", "[", "x__", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"ListLogPlot", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
     RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StyledErrorListPlot", "[", "x__", "]"}], ":=", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"ErrorListPlot", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Gray", ",", "Dashed"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StyledErrorListPlotRegression", "[", 
     RowBox[{"y__", ",", "lm_"}], "]"}], ":=", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{"y", ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", " ", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", "Dashed"}], "]"}]}], ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Framed", "[", 
              RowBox[{
               RowBox[{"lm", "[", "\"\<ParameterTable\>\"", "]"}], ",", 
               RowBox[{"Background", "\[Rule]", "LightGreen"}]}], "]"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"Axis", ",", "Top"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Top"}], "}"}]}], "]"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"lm", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1000"}], "}"}], ",", " ", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"Placed", "[", " ", 
            RowBox[{
             RowBox[{"\"\<y\>\"", "==", 
              RowBox[{"Normal", "[", "lm", "]"}]}], ",", "Above"}], "]"}]}], 
          ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "500"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimpleTable", "[", 
     RowBox[{"data_", ",", " ", 
      RowBox[{"labels_:", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"accuracy_:", "4"}]}], "]"}], " ", ":=", "\n", 
    RowBox[{"Return", "[", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"Grid", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"labels", " ", "!=", " ", 
              RowBox[{"{", "}"}]}], ",", " ", 
             RowBox[{"Prepend", "[", 
              RowBox[{"data", ",", " ", "labels"}], "]"}]}], "]"}], ",", " ", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Background", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{"None", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"White", ",", " ", 
                   RowBox[{"Lighter", "[", 
                    RowBox[{
                    RowBox[{"Blend", "[", 
                    RowBox[{"{", 
                    RowBox[{"Gray", ",", " ", "Gray"}], "}"}], "]"}], ",", 
                    " ", "0.85`"}], "]"}]}], "}"}], "}"}]}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Alignment", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"labels", " ", "!=", " ", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"{", 
                   RowBox[{"Center", ",", "\"\<.\>\""}], "}"}]}], "}"}], ",", 
                "\"\<.\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ItemStyle", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"labels", " ", "!=", " ", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{"Bold", ",", "Larger"}], "]"}], ",", 
                    RowBox[{"{", "Automatic", "}"}]}], "}"}]}], "}"}], ",", 
                "Automatic"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Dividers", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"Gray", ",", 
                 RowBox[{"{", "LightGray", "}"}], ",", "Gray"}], "}"}], 
               "}"}]}], ",", " ", 
             RowBox[{"Alignment", " ", "->", " ", "Right"}], ",", " ", 
             RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
             RowBox[{"Spacings", " ", "->", " ", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"labels", " ", "!=", " ", 
                   RowBox[{"{", "}"}]}], ",", " ", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", " ", 
                    RowBox[{"{", "0.3`", "}"}]}], "}"}], ",", 
                  RowBox[{"{", "0.3`", "}"}]}], "]"}]}], "}"}]}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "+", "accuracy"}], ",", "accuracy"}], "}"}]}], "]"}], 
       ",", " ", "\"\<Table\>\"", ",", " ", 
       RowBox[{"TextAlignment", " ", "->", " ", "Center"}]}], "]"}], "]"}]}], 
   ";"}], "\n", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"LinearRegressionXYError", "[", 
    RowBox[{
     RowBox[{"data_", "?", "MatrixQ"}], ",", " ", 
     RowBox[{"errs_", "?", "MatrixQ"}]}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "data", "]"}]}], ",", " ", "c", ",", " ", 
        "ct", ",", " ", "dk", ",", " ", "dm", ",", " ", "k", ",", " ", "m", 
        ",", " ", "p", ",", " ", "s", ",", " ", "st", ",", " ", "ul", ",", 
        " ", "vl", ",", " ", "w", ",", " ", "wt", ",", " ", "xm", ",", " ", 
        "ym"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ct", ",", " ", "st", ",", " ", "k"}], "}"}], " ", "=", " ", 
        
        RowBox[{"Flatten", "[", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", " ", "#"}], "}"}], "]"}], " ", "&"}], ",", 
           " ", 
           RowBox[{"NArgMin", "[", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", " ", "y"}], "}"}], ",", " ", 
                 RowBox[{"y", " ", "-", " ", 
                  RowBox[{"\[FormalM]", " ", "x"}], " ", "-", " ", 
                  "\[FormalK]"}]}], "]"}], " ", "@@@", " ", "data"}], "]"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"\[FormalM]", ",", " ", "\[FormalK]"}], "}"}]}], "]"}], 
           ",", " ", "1"}], "]"}], "]"}]}], ";", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{
        "find", " ", "orthogonal", " ", "regression", " ", "coefficients"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"c", ",", " ", "s", ",", " ", "p"}], "}"}], " ", "=", " ", 
        RowBox[{"FindArgMin", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"data", ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "\[FormalS]"}], ",", " ", "\[FormalC]"}], 
                   "}"}]}], " ", "-", " ", "\[FormalP]"}], ")"}], "^", "2"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"errs", "^", "2"}], ")"}], ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[FormalS]", "^", "2"}], ",", " ", 
                  RowBox[{"\[FormalC]", "^", "2"}]}], "}"}]}], ")"}]}], "]"}],
             ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"\[FormalC]", "^", "2"}], " ", "+", " ", 
              RowBox[{"\[FormalS]", "^", "2"}]}], " ", "==", " ", "1"}]}], 
           "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[FormalC]", ",", " ", "ct"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[FormalS]", ",", " ", "st"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[FormalP]", ",", " ", 
              RowBox[{"k", "/", "ct"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{"slope", " ", "and", " ", "intercept"}], "*)"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "k"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", ",", " ", "p"}], "}"}], "/", "c"}]}], ";", "\n", "   ", 
       RowBox[{"wt", " ", "=", " ", 
        RowBox[{"1", "/", 
         RowBox[{"errs", "^", "2"}]}]}], ";", " ", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Times", " ", "@@@", " ", "wt"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"wt", ".", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", 
             RowBox[{"m", "^", "2"}]}], "}"}]}], ")"}]}]}], ";", "\n", "   ", 
       
       RowBox[{
        RowBox[{"{", 
         RowBox[{"xm", ",", " ", "ym"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"w", ".", "data"}], "/", 
         RowBox[{"Total", "[", "w", "]"}]}]}], ";", "\n", "   ", 
       RowBox[{"ul", " ", "=", " ", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
         "xm"}]}], ";", " ", 
       RowBox[{"vl", " ", "=", " ", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], " ", "-", " ", 
         "ym"}]}], ";", "\n", "   ", 
       RowBox[{"(*", 
        RowBox[{
        "uncertainties", " ", "in", " ", "slope", " ", "and", " ", 
         "intercept"}], "*)"}], 
       RowBox[{"dm", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"w", ".", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m", " ", "ul"}], " ", "-", " ", "vl"}], ")"}], "^", 
            "2"}]}], "/", 
          RowBox[{"w", ".", 
           RowBox[{"ul", "^", "2"}]}]}], "/", 
         RowBox[{"(", 
          RowBox[{"n", " ", "-", " ", "2"}], ")"}]}]}], ";", "\n", "   ", 
       RowBox[{"dk", " ", "=", " ", 
        RowBox[{"dm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", ".", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "1"}], "]"}], "]"}], "^", "2"}]}], 
           "/", 
           RowBox[{"Total", "[", "w", "]"}]}], ")"}]}]}], ";", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[FormalX]", ",", " ", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", " ", "k"}], "}"}], ".", 
             RowBox[{"{", 
              RowBox[{"\[FormalX]", ",", " ", "1"}], "}"}]}], "]"}]}], "]"}], 
         ",", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"{", 
           RowBox[{"dm", ",", " ", "dk"}], "}"}], "]"}]}], "}"}]}]}], "]"}], 
    " ", "/;", " ", 
    RowBox[{
     RowBox[{"Dimensions", "[", "data", "]"}], " ", "===", " ", 
     RowBox[{"Dimensions", "[", "errs", "]"}]}]}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"bigImgSize", " ", "=", " ", "550"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"smallImgSize", " ", "=", " ", "350"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotRegression", "[", 
     RowBox[{"lr_", ",", " ", "data_", ",", " ", "errors_", ",", " ", 
      RowBox[{"labels_:", " ", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"func_:", "True"}], ",", 
      RowBox[{"range_:", "Automatic"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dataErrors", ",", " ", "names"}], "}"}], ",", "\n", "   ", 
      RowBox[{
       RowBox[{"dataErrors", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", 
             RowBox[{"ErrorBar", "[", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"#2", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], " ", "&"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"data", ",", " ", "errors"}], "}"}]}], "]"}]}], ";", "\n", 
       "   ", 
       RowBox[{"names", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lr", "[", "x", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"x", "*", 
            RowBox[{
             RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"x", "*", 
            RowBox[{
             RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", " ", "2"}], "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", "2"}], "]"}], "]"}]}]}], "}"}]}], ";", 
       "\n", "   ", 
       RowBox[{"Return", "[", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ErrorListPlot", "[", 
           RowBox[{"dataErrors", ",", 
            RowBox[{"PlotMarkers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "4"}], "}"}]}], ",", 
            RowBox[{"ErrorBarFunction", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{"func", ",", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"coords", ",", " ", "errs"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
                   RowBox[{"Rectangle", "[", 
                    RowBox[{
                    RowBox[{"coords", "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"errs", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"errs", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ",", 
                    RowBox[{"coords", "+", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"errs", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"errs", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}]}], "]"}]}], "}"}]}], "]"}], ",", "Automatic"}], 
              "]"}]}], ",", " ", 
            RowBox[{"ImageSize", " ", "->", " ", "bigImgSize"}], ",", " ", 
            RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
            RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
            RowBox[{"FrameStyle", " ", "->", " ", "Gray"}], ",", " ", 
            RowBox[{"FrameLabel", " ", "->", " ", "labels"}], ",", " ", 
            RowBox[{"GridLines", " ", "->", " ", "Automatic"}], ",", " ", 
            RowBox[{"GridLinesStyle", " ", "->", " ", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", " ", "Dashed"}], "]"}]}]}], "]"}], ",", 
          " ", 
          RowBox[{"Plot", "[", 
           RowBox[{"names", ",", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "0", ",", " ", 
              RowBox[{"First", "[", 
               RowBox[{"Last", "[", "data", "]"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"PlotStyle", " ", "->", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"Thick", ",", " ", "Red"}], "]"}], ",", " ", 
               RowBox[{"Directive", "[", 
                RowBox[{"Dashed", ",", " ", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}], ",", " ", 
               RowBox[{"Directive", "[", 
                RowBox[{"Dashed", ",", " ", 
                 RowBox[{"Darker", "[", "Gray", "]"}]}], "]"}]}], "}"}]}], 
            ",", " ", 
            RowBox[{"PlotLegends", " ", "->", " ", 
             RowBox[{"Placed", "[", 
              RowBox[{"names", ",", " ", "Above"}], "]"}]}]}], "]"}]}], "]"}],
         "]"}]}]}], "\n", "   ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{",", 
          RowBox[{"TextAlignment", "\[Rule]", "Center"}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\n", "   ", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"da", "[", "lr_", "]"}], " ", ":=", " ", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"lr", "[", "x", "]"}], ",", " ", "x"}], "]"}], " ", "-", " ", 
     RowBox[{
      RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"db", "[", "lr_", "]"}], " ", ":=", " ", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"lr", "[", "0", "]"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"lr", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], "[", 
       
       RowBox[{"[", 
        RowBox[{"1", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"QuantityMagnitude", "[", "x", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "[", 
    RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Quantity", "[", 
    RowBox[{"x", ",", " ", "u"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FixUnit", "[", 
   RowBox[{"x_", ",", " ", "jednostka_"}], "]"}], " ", ":=", " ", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{"x", ",", " ", 
    RowBox[{"Quantity", "[", "jednostka", "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PresentValue", "[", 
     RowBox[{"var_", ",", " ", 
      RowBox[{"units_", " ", ":", " ", "\"\<\>\""}], ",", " ", 
      RowBox[{"prec_", " ", ":", " ", "2"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"units", " ", "==", " ", "\"\<\>\""}], ",", " ", 
        RowBox[{"Q", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"var", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "\[PlusMinus]", " ", 
           RowBox[{"var", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"var", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"Q", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"FixUnit", "[", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "units"}],
              "]"}], "]"}], " ", "\[PlusMinus]", " ", 
           RowBox[{"M", "[", 
            RowBox[{"FixUnit", "[", 
             RowBox[{
              RowBox[{"Q", "[", 
               RowBox[{
                RowBox[{"var", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "units"}],
              "]"}], "]"}]}], ",", " ", "units"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"20", ",", " ", "prec"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{"C_", " ", 
     RowBox[{"Mes", "[", 
      RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", "C", "]"}], " ", "x"}], ",", 
       RowBox[{
        RowBox[{"M", "[", "C", "]"}], " ", "dx"}], ",", 
       RowBox[{
        RowBox[{"QuantityUnit", "[", "C", "]"}], " ", "u"}]}], "]"}], "/;", 
     " ", 
     RowBox[{"QuantityQ", "[", "C", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{"C_", " ", 
     RowBox[{"Mes", "[", 
      RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{
       RowBox[{"C", " ", "x"}], ",", 
       RowBox[{"C", " ", "dx"}], ",", "u"}], "]"}], "/;", " ", 
     RowBox[{"NumberQ", "[", "C", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "+", 
     RowBox[{"Mes", "[", 
      RowBox[{"x2_", ",", "dx2_", ",", "u2_"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{
       RowBox[{"x", "+", "x2"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"dx", "^", "2"}], "+", 
         RowBox[{"dx2", "^", "2"}]}], "]"}], ",", "u"}], "]"}], "/;", " ", 
     RowBox[{"u", "\[Equal]", "u2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "-", 
     RowBox[{"Mes", "[", 
      RowBox[{"x2_", ",", "dx2_", ",", "u2_"}], "]"}]}], ":=", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{
       RowBox[{"x", "-", "x2"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"dx", "^", "2"}], "+", 
         RowBox[{"dx2", "^", "2"}]}], "]"}], ",", "u"}], "]"}], "/;", " ", 
     RowBox[{"u", "\[Equal]", "u2"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{
    RowBox[{"Mes", "[", 
     RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "*", 
    RowBox[{"Mes", "[", 
     RowBox[{"x2_", ",", "dx2_", ",", "u2_"}], "]"}]}], ":=", 
   RowBox[{"Mes", "[", 
    RowBox[{
     RowBox[{"x", "*", "x2"}], ",", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", " ", "dx"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", " ", "dx2"}], ")"}], "^", "2"}]}], " ", "]"}], ",", 
     RowBox[{
      RowBox[{"(", "u", " ", ")"}], " ", "*", 
      RowBox[{"(", "u2", ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], " ", "/", " ", 
     RowBox[{"Mes", "[", 
      RowBox[{"x2_", ",", "dx2_", ",", "u2_"}], "]"}]}], ":=", 
    RowBox[{"Mes", "[", 
     RowBox[{
      RowBox[{"x", "/", "x2"}], ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"dx", "/", "x2"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"dx2", " ", 
           RowBox[{"x", "/", 
            RowBox[{
             RowBox[{"(", "x2", ")"}], "^", "2"}]}]}], ")"}], "^", "2"}]}], 
       " ", "]"}], ",", 
      RowBox[{
       RowBox[{"(", "u", ")"}], " ", "/", 
       RowBox[{"(", "u2", ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{"Exp", "[", 
    RowBox[{"Mes", "[", 
     RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "]"}], ":=", 
   RowBox[{"Mes", "[", 
    RowBox[{
     RowBox[{"Exp", "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"Exp", "[", "x", "]"}], " ", "dx"}], ",", "u"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{"Sin", "[", 
    RowBox[{"Mes", "[", 
     RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "]"}], ":=", 
   RowBox[{"Mes", "[", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"Cos", "[", "x", "]"}], "]"}], " ", "dx"}], ",", "u"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{"Cos", "[", 
    RowBox[{"Mes", "[", 
     RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], "]"}], ":=", 
   RowBox[{"Mes", "[", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"Sin", "[", "x", "]"}], "]"}], " ", "dx"}], ",", "u"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"Mes", "[", 
       RowBox[{"x_", ",", "dx_", ",", "u_"}], "]"}], ",", "n_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"x", ",", "n"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{"x", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}], " ", "dx"}], ",", " ", 
       RowBox[{"u", "^", "n"}]}], "]"}], "/;", " ", 
     RowBox[{"NumberQ", "[", "n", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{"MakeBoxes", "[", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{"mess_", ",", "error_", ",", "unit_"}], "]"}], ",", 
     RowBox[{"form", ":", 
      RowBox[{"(", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}], ")"}], ":", 
      "StandardForm"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"RowBox", "[", 
    RowBox[{"{", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"NumberForm", "[", 
        RowBox[{
         RowBox[{"Quantity", "[", 
          RowBox[{
           RowBox[{"mess", " ", "\[PlusMinus]", " ", "error"}], ",", "unit"}],
           "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "2"}], "}"}]}], "]"}], ",", "form"}], "]"}], 
     "}"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Error", " ", "alone", " ", "is", " ", "not", " ", "subject", " ", "to", 
    " ", "formatting"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mes", "/:", 
   RowBox[{"MakeBoxes", "[", 
    RowBox[{
     RowBox[{"Mes", "[", 
      RowBox[{"0", ",", "error_", ",", "unit_"}], "]"}], ",", 
     RowBox[{"form", ":", 
      RowBox[{"(", 
       RowBox[{"StandardForm", "|", "TraditionalForm"}], ")"}], ":", 
      "StandardForm"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"RowBox", "[", 
    RowBox[{"{", 
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"Quantity", "[", 
        RowBox[{"error", ",", "unit"}], "]"}], ",", "form"}], "]"}], "}"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Mes", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"Mes", "[", 
     RowBox[{"mess_", ",", "0", ",", "unit_"}], "]"}], ",", 
    RowBox[{"form", ":", 
     RowBox[{"(", 
      RowBox[{"StandardForm", "|", "TraditionalForm"}], ")"}], ":", 
     "StandardForm"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"RowBox", "[", 
   RowBox[{"{", 
    RowBox[{"MakeBoxes", "[", 
     RowBox[{
      RowBox[{"NumberForm", "[", 
       RowBox[{
        RowBox[{"Quantity", "[", 
         RowBox[{"mess", ",", "unit"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "2"}], "}"}]}], "]"}], ",", "form"}], "]"}], 
    "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mes", "/:", 
    RowBox[{"\[CapitalDelta]", "[", 
     RowBox[{"Mes", "[", 
      RowBox[{"value_", ",", "error_", ",", "unit_"}], "]"}], "]"}], ":=", 
    "error"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"EquationNumbered", ",", "HoldAllComplete"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EquationNumbered", "[", 
     RowBox[{"fun_", ",", " ", 
      RowBox[{"tags_:", " ", "\"\<\>\""}]}], "]"}], " ", ":=", " ", "\n", 
    "   ", 
    RowBox[{"StylePrint", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"HoldForm", "[", "fun", "]"}], " ", "\[Equal]", "fun"}], ",", 
      " ", "\"\<EquationNumbered\>\"", ",", " ", 
      RowBox[{"CellTags", " ", "->", " ", "tags"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"DD", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DD", "[", 
     RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"HoldForm", "[", 
     RowBox[{
      SubscriptBox["\[PartialD]", "var"], "f"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CSE", "[", "e_", "]"}], ":=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringFreeQ", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"e", ",", "InputForm"}], "]"}], ",", 
          "\"\<Subscript[\>\""}], "]"}], ",", 
        RowBox[{"\"\<\[CapitalDelta]\>\"", "<>", 
         RowBox[{"ToString", "[", "e", "]"}], "<>", "\"\<\>\""}], ",", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"e", ",", "InputForm"}], "]"}], ",", 
          RowBox[{
          "\"\<Subscript[\>\"", "\[Rule]", 
           "\"\<Subscript[\[CapitalDelta]\>\""}]}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CSE", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CSE", "[", "e_", "]"}], ":=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringFreeQ", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"FullForm", "@", 
            RowBox[{"HoldForm", "@", "e"}]}], "]"}], ",", 
          "\"\<HoldForm[Subscript[\>\""}], "]"}], ",", 
        RowBox[{"\"\<\[CapitalDelta]\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"HoldForm", "@", "e"}], "]"}], "<>", "\"\<\>\""}], ",", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"FullForm", "@", 
            RowBox[{"HoldForm", "@", "e"}]}], "]"}], ",", 
          RowBox[{
          "\"\<HoldForm[Subscript[\>\"", "\[Rule]", 
           "\"\<HoldForm[Subscript[\[CapitalDelta]\>\""}]}], "]"}]}], "]"}], 
      ",", "TraditionalForm", ",", "HoldForm"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CSE", "[", "e_", "]"}], ":=", 
    RowBox[{"Print", "[", 
     RowBox[{"HoldForm", "@", "e"}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"TDE", ",", "HoldFirst"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TDE", "[", 
     RowBox[{"fun2_", ",", "vars2__"}], "]"}], ":=", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"CSE", "[", "#", "]"}], " ", 
               RowBox[{"DD", "[", 
                RowBox[{"fun2", ",", "#"}], "]"}]}], ")"}], "2"], ")"}], 
           "&"}], "/@", " ", "vars2"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TDE", "[", 
      RowBox[{"fun2_", ",", "vars2__"}], "]"}], ":=", 
     RowBox[{"Print", "[", 
      RowBox[{"HoldForm", "@", 
       RowBox[{"{", "vars2", "}"}]}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"TotalDiffrentialError", ",", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TotalDiffrentialError", "[", 
     RowBox[{"fun_", ",", "vars__"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Expanded", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StylePrint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CSE", "[", "fun", "]"}], "\[Equal]", 
          RowBox[{"TDE", "[", 
           RowBox[{"fun", ",", "vars"}], "]"}]}], ",", 
         "\"\<EquationNumbered\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"StylePrint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CSE", "[", "fun", "]"}], "\[Equal]", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{
            RowBox[{"ReleaseHold", "[", 
             RowBox[{"TDE", "[", 
              RowBox[{"fun", ",", "vars"}], "]"}], "]"}], ",", 
            RowBox[{"TransformationFunctions", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "PowerExpand"}], "}"}]}]}], "]"}]}], 
         ",", "\"\<EquationNumbered\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"ReleaseHold", "[", 
         RowBox[{"TDE", "[", 
          RowBox[{"fun", ",", "vars"}], "]"}], "]"}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 CellOpen->True,
 InitializationCell->
  True,ExpressionUUID->"240d7731-5561-4ed6-978d-cc9f6bff6bd8"]
},
AutoGeneratedPackage->Automatic,
WindowSize->{960, 1155},
WindowMargins->{{Automatic, 0}, {Automatic, -1}},
ShowCellLabel->True,
ShowCellTags->True,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"], CellID -> 1525097360], 
   Cell[
    StyleData["usage"], MenuSortingValue -> 10000, CellID -> 2094002575], 
   Cell[
    StyleData["Usage"], MenuSortingValue -> 10000, CellID -> 939270989]}, 
  Visible -> False, FrontEndVersion -> 
  "11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 41449, 1118, 3509, "Input", "ExpressionUUID" -> \
"240d7731-5561-4ed6-978d-cc9f6bff6bd8",
 CellOpen->True,
 InitializationCell->True]
}
]
*)

